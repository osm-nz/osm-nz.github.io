(this["webpackJsonplinz-address-import-homepage"]=this["webpackJsonplinz-address-import-homepage"]||[]).push([[0],{29:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(13),c=n.n(a),s=n(1),i=n(0),o={PERFECT:[1,"Data is already perfect","No action required"],EXISTS_BUT_WRONG_DATA:[2,"Address exists but the data is wrong","Select a suburb in the tool, edits will be shown","data-wrong.txt"],EXISTS_BUT_NO_LINZ_REF:[3,"Address exists but no linz ref","Select a suburb in the tool, edits will be shown","needs-linz-ref.txt"],MULTIPLE_EXIST_BUT_NO_LINZ_REF:[4,"Multiple addresses exists, none have linz ref","manual action required","needs-linz-ref-but-multiple.txt"],MULTIPLE_EXIST:[5,"Multiple addresses exists with same linz ref","manual action required","duplicate-linz-ref.txt"],EXISTS_BUT_LOCATION_WRONG:[6,"Addresses exist but location is very wrong",'Select the suburb called "ZZ Special Location Wrong".',"location-wrong.txt"],TOTALLY_MISSING:[7,"Addresses totally missing from OSM","Select a suburb in the tool"],NEEDS_DELETE:[8,"Addresses in OSM that have been deleted by LINZ","Select a suburb in the tool. Addresses to be deleted will be shown in red.","needs-delete.txt"],NEEDS_DELETE_NON_TRIVIAL:[9,"Addresses in OSM that have been deleted by LINZ, but are on a OSM building or business","manual action required","needs-delete-non-trivial.txt"],CORRUPT:[10,"There are multiple LINZ refs on the same OSM node","manual action required","corrupt.txt"],LINZ_REF_CHANGED:[11,"LINZ has changed their ID for an address, but not the data","Select the suburb called 'ZZ Special Linz Ref Changed'","linz-ref-changed.txt"],COULD_BE_STACKED:[13,"Addresses in OSM that are perfect, but the flats/units could be stacked if this is desired.","N/A. Just for statistics","could-be-stacked.txt"]},d="https://linz-addr-cdn.kyle.kiwi",l=function(){var e=Object(s.useState)(),t=Object(r.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(),l=Object(r.a)(c,2),h=l[0],j=l[1];if(Object(s.useEffect)((function(){fetch("".concat(d,"/stats.json")).then((function(e){return e.json()})).then(j).catch(a)}),[]),n)return Object(i.jsx)(i.Fragment,{children:"Error."});if(!h)return Object(i.jsx)(i.Fragment,{children:"Loading..."});var u=new Date(h.date),b=Math.round((+new Date-+u)/1e3/60/60);return Object(i.jsxs)("div",{style:{margin:15},children:[Object(i.jsx)("a",{href:"./RapiD/",className:"start",children:"\u2728 Click to start mapping!"}),Object(i.jsxs)("table",{className:"busy",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{style:{fontWeight:600},children:[Object(i.jsx)("td",{children:"Code"}),Object(i.jsx)("td",{children:"Data Category"}),Object(i.jsx)("td",{children:"No. of addresses"}),Object(i.jsx)("td",{children:"Percentage of total"}),Object(i.jsx)("td",{children:"How to action"}),Object(i.jsx)("td",{children:"Raw data"})]})}),Object(i.jsx)("tbody",{children:Object.entries(h.count).map((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1],c=Object(r.a)(o[n],4),s=c[0],l=c[1],j=c[2],u=c[3];return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:s}),Object(i.jsx)("td",{children:l}),Object(i.jsx)("td",{children:a.toLocaleString("en-nz")}),Object(i.jsxs)("td",{children:[(a/h.total*100).toFixed(2),"%"]}),Object(i.jsx)("td",{children:j}),u&&Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:"".concat(d,"/").concat(u),children:"download"})})]})}))})]}),Object(i.jsxs)("p",{style:{margin:12},children:["Statistics last updated on ",u.toLocaleString("en-nz")," (",b," hours ago)"]}),Object(i.jsxs)("footer",{children:["For more infomation, see:",Object(i.jsxs)("ul",{children:[Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"https://wiki.openstreetmap.org/wiki/Import/New_Zealand_Street_Addresses_(2021)",children:"the wiki page"})}),Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"https://github.com/osm-nz/linz-address-import",children:"the repository containing the source code"})}),Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"https://osmcha.org/?aoi=5a4d6cbe-37f9-4b5b-a6d6-0c69dd488a07",children:"All changesets uploaded so far"})}),Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"https://github.com/osm-nz/linz-address-import/issues/1",children:"The import progress"})}),Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:"#/map",children:"A map of all the sectors requiring attention"})})]})]})]})},h=n(32),j=n(33),u=n(36),b=n(34),O=n(35);var p=n(18),f=function(e,t){return Object(p.a)(new Map(t.map((function(t){return[t[e],t]}))).values())},x=(n(16),n(28),"https://linz-addr-cdn.kyle.kiwi"),m=!!window.opener;function g(e){return e>1e3?"#3a0000":e>500?"#67001f":e>200?"#980043":e>100?"#ce1256":e>60?"#e7298a":e>40?"#df65b0":e>20?"#c994c7":"#d4b9da"}function w(e,t){return{color:t?"#aaaaaa":g(e.totalCount),fillOpacity:.3,opacity:1,stroke:!0,weight:2}}var y="orange";function S(e,t){t?(y=e.target.options.color,e.target.setStyle({color:"yellow"})):e.target.setStyle({color:y})}function v(e){var t=Object(r.a)(e,2),n=Object(r.a)(t[0],2),a=n[0],c=n[1],s=Object(r.a)(t[1],2),i=s[0],o=s[1];return[[o,a],[o,i],[c,i],[c,a]]}var E={Expires:"Tue, 01 Jan 1980 1:00:00 GMT","Cache-Control":"no-cache, no-store, max-age=0",Pragma:"no-cache"},L=function(){var e=Object(s.useState)(!1),t=Object(r.a)(e,2),n=t[0],a=t[1],c=Object(s.useState)(),o=Object(r.a)(c,2),d=o[0],l=o[1],p=Object(s.useState)(),y=Object(r.a)(p,2),L=y[0],z=y[1],_=Object(s.useState)(),N=Object(r.a)(_,2),k=N[0],T=N[1];if(Object(s.useEffect)((function(){Promise.all([fetch("".concat(x,"/index.json?nocache=").concat(Math.random()),{headers:E}).then((function(e){return e.json()})),fetch("".concat(x,"/__locked?nocache=").concat(Math.random()),{headers:E}).then((function(e){return e.json()})).catch((function(){return{}}))]).then(T).catch(z)}),[]),L)return Object(i.jsx)(i.Fragment,{children:"Error"});if(!k)return Object(i.jsx)(i.Fragment,{children:"Loading..."});var I=f("name",k[0].results.map((function(e){return{name:e.name.split(" - ")[0],isPreview:"/Categories/Preview"===e.groupCategories[0]}})).filter((function(e){return n||!e.isPreview}))),C=function(e){return k[1][e.id]?"Someone else ".concat("done"===k[1][e.id][1]?"may have already uploaded":"is working on"," this dataset! Check back in one day."):""};return console.log({data:k}),Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)("div",{style:{height:200},children:[m&&Object(i.jsxs)("div",{style:{textAlign:"center"},children:[Object(i.jsx)("h3",{style:{margin:0},children:"Please select a suburb to edit"}),"You can close this page and use the list if you prefer"]}),Object(i.jsx)("input",{type:"checkbox",checked:n,onChange:function(e){return a(e.target.checked)}}),"Show Preview Layers",Object(i.jsx)("br",{}),Object(i.jsx)("br",{}),Object(i.jsx)("div",{style:{display:"flex",flexWrap:"wrap"},children:I.map((function(e){return Object(i.jsx)("button",{type:"button",className:[d===e.name?"active-layer":"inactive-layer",e.isPreview?"preview-layer":""].join(" "),onClick:function(){return l(e.name)},children:e.name},e.name)}))})]}),Object(i.jsxs)(h.a,{style:{width:"100vw",height:"calc(100vh - 200px)"},center:[-40.98,166.9],zoom:6,scrollWheelZoom:!0,children:[Object(i.jsxs)(j.a,{position:"topright",children:[Object(i.jsx)(j.a.BaseLayer,{checked:!0,name:"OpenStreetMap",children:Object(i.jsx)(u.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),Object(i.jsx)(j.a.BaseLayer,{name:"LINZ Aerial Imagery",children:Object(i.jsx)(u.a,{attribution:'<a href="https://www.linz.govt.nz/data/licensing-and-using-data/attributing-elevation-or-aerial-imagery-data">Sourced from LINZ CC-BY 4.0</a>',url:"https://basemaps.linz.govt.nz/v1/tiles/aerial/EPSG:3857/{z}/{x}/{y}.jpg?api=d01egend5f8dv4zcbfj6z2t7rs3"})}),Object(i.jsx)(j.a.BaseLayer,{name:"LINZ Topo50",children:Object(i.jsx)(u.a,{attribution:'<a href="https://www.linz.govt.nz/data/licensing-and-using-data/attributing-elevation-or-aerial-imagery-data">Sourced from LINZ CC-BY 4.0</a>',url:"https://map.cazzaserver.com/linz_topo/{z}/{x}/{y}.png"})})]}),d&&k[0].results.filter((function(e){return e.name.startsWith(d)})).map((function(e){return Object(i.jsx)(b.a,{pathOptions:w(e,k[1][e.id]),positions:v(e.extent),eventHandlers:{click:function(){m&&function(e,t){if(t){var n=Object(r.a)(t,2),a=n[0],c=n[1],s="Check back in a day.\n\nIf you continue, you might override or duplicate their work!",i="done"===c?"This dataset may already have been uploaded by someone else! ".concat(s):"Someone else (".concat(a,") started editing this dataset ").concat(c," minutes ago. ").concat(s);if(!confirm(i))return}window.opener.postMessage("ADD_SECTOR=".concat(e)),window.close()}(e.id,k[1][e.id])},mouseover:function(e){return S(e,!0)},mouseout:function(e){return S(e,!1)}},children:Object(i.jsxs)(O.a,{direction:"bottom",sticky:!0,children:[Object(i.jsx)("strong",{children:e.name}),Object(i.jsx)("br",{}),e.snippet,Object(i.jsx)("br",{}),C(e)]})})})),Object(i.jsxs)("div",{className:"legend leaflet-bottom leaflet-left",style:{margin:20},children:[Object(i.jsx)("strong",{children:"# of changes"}),Object(i.jsx)("br",{}),[0,20,40,60,100,200,500,1e3].map((function(e,t,n){return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("i",{style:{background:g(n[t]+1)}}),n[t],n[t+1]?Object(i.jsxs)(i.Fragment,{children:["\u2013",n[t+1],Object(i.jsx)("br",{})]}):"+"]})}))]})]})]})},z=function(){return Object(i.jsx)(i.Fragment,{children:"Hello!"})},_=(n(29),function(){return window.location.hash.substr(1)}),N=function(){var e=Object(s.useState)(_()),t=Object(r.a)(e,2),n=t[0],a=t[1];return Object(s.useEffect)((function(){var e=function(){return a(_())};return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}),[]),"/whatsup"===n?Object(i.jsx)(z,{}):"/map"===n?Object(i.jsx)(L,{}):Object(i.jsx)(l,{})};c.a.render(Object(i.jsx)(s.StrictMode,{children:Object(i.jsx)(N,{})}),document.querySelector("main"))}},[[30,1,2]]]);
//# sourceMappingURL=main.83e5e306.chunk.js.map